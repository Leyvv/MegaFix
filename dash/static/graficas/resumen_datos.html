<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Resumen</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    .container {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 15px;
      max-width: 1200px;
      margin: auto;
    }

    .box {
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.07);
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: bold;
      color: #3b3b3b;
    }

    .box i {
      font-size: 22px;
    }

    .content {
      display: flex;
      flex-direction: column;
    }

    .label {
      font-size: 13px;
      font-weight: 700;
    }

    .value {
      font-size: 16px;
      font-weight: 700;
      margin-top: 2px;
    }

    .box:nth-child(6n+1) { background: linear-gradient(135deg, #F4A261, #E65D1D); color: white; }
    .box:nth-child(6n+2) { background: linear-gradient(135deg, #E65D1D, #F28D2C); color: white; }
    .box:nth-child(6n+3) { background: linear-gradient(135deg, #F28D2C, #F4A261); color: white; }
    .box:nth-child(6n+4) { background: linear-gradient(135deg, #F4A261, #F9B974); color: #2f2f2f; }
    .box:nth-child(6n+5) { background: linear-gradient(135deg, #F9B974, #FEE9C8); color: #2f2f2f; }
    .box:nth-child(6n+6) { background: linear-gradient(135deg, #FEE9C8, #FFFFFF); color: #2f2f2f; }

    .box:hover {
      transform: translateY(-4px);
    }

    @media (max-width: 768px) {
      .container {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 480px) {
      .container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="box">
      <i class="fas fa-calendar-day"></i>
      <div class="content">
        <div class="label">Día más vendido</div>
      </div>
    </div>
    <div class="box"><div class="content"><div class="value" id="dia-mayor1">---</div></div></div>
    <div class="box"><div class="content"><div class="value" id="dia-mayor2">---</div></div></div>
    <div class="box"><div class="content"><div class="value" id="dia-mayor3">---</div></div></div>
    <div class="box"><div class="content"><div class="value" id="dia-mayor4">---</div></div></div>
    <div class="box"><div class="content"><div class="value" id="dia-mayor5">---</div></div></div>

    <div class="box">
      <i class="fas fa-dollar-sign"></i>
      <div class="content">
        <div class="label">Total</div>
      </div>
    </div>
    <div class="box"><div class="content"><div class="value" id="valor-mayor1">---</div></div></div>
    <div class="box"><div class="content"><div class="value" id="valor-mayor2">---</div></div></div>
    <div class="box"><div class="content"><div class="value" id="valor-mayor3">---</div></div></div>
    <div class="box"><div class="content"><div class="value" id="valor-mayor4">---</div></div></div>
    <div class="box"><div class="content"><div class="value" id="valor-mayor5">---</div></div></div>
  </div>

  <script>
    async function cargarDatos() {
      const año = localStorage.getItem('añoSeleccionado');
      const mes = localStorage.getItem('mesSeleccionado');

      if (!año || !mes) {
        console.error("No se ha seleccionado un mes o año");
        return;
      }

      const mapaMeses = {
        "enero": "01", "febrero": "02", "marzo": "03", "abril": "04", "mayo": "05", "junio": "06",
        "julio": "07", "agosto": "08", "septiembre": "09", "octubre": "10", "noviembre": "11", "diciembre": "12"
      };

      const numeroMes = mapaMeses[mes.toLowerCase()];
      if (!numeroMes) {
        console.error("Mes no válido:", mes);
        return;
      }

      try {
        const response = await fetch("/static/graficas/mayores_dias_venta.json");
        const datos = await response.json();

        const resultados = datos.filter(item => {
          const [anio, mesStr] = item.Fecha.split('-');
          return anio === año && mesStr === numeroMes;
        });

        if (resultados.length === 0) {
          for (let i = 1; i <= 5; i++) {
            document.getElementById(`dia-mayor${i}`).textContent = "No encontrado";
            document.getElementById(`valor-mayor${i}`).textContent = "--";
          }
          return;
        }

        resultados.sort((a, b) => b.TotalDia - a.TotalDia);
        resultados.slice(0, 5).forEach((item, index) => {
          const suffix = index + 1;
          document.getElementById(`dia-mayor${suffix}`).textContent = item.Fecha;
          document.getElementById(`valor-mayor${suffix}`).textContent = `$ ${parseFloat(item.TotalDia).toLocaleString('es-MX', { minimumFractionDigits: 2 })}`;
        });

      } catch (error) {
        console.error("Error al cargar el JSON:", error);
      }
    }

    window.addEventListener('DOMContentLoaded', cargarDatos);
  </script>
</body>
</html>
